Search.setIndex({"docnames": ["Spark_Pandas_Polars", "intro"], "filenames": ["Spark_Pandas_Polars.ipynb", "intro.md"], "titles": ["<em><strong>Spark vs Pandas vs Polars: time analysis</strong></em>", "Time Analysis of <code class=\"docutils literal notranslate\"><span class=\"pre\">Spark</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">Polars</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">Pandas</span></code>"], "terms": {"In": 0, "thi": [0, 1], "project": [0, 1], "we": 0, "have": 0, "carri": 0, "out": 0, "three": [0, 1], "provid": 0, "csv": 0, "file": 0, "inform": 0, "about": 0, "new": 0, "york": 0, "had": 0, "dataset": 0, "first": 0, "remov": 0, "record": 0, "wrong": 0, "outlier": 0, "To": 0, "wa": 0, "us": 0, "entir": 0, "": 0, "api": 0, "includ": 0, "manipul": 0, "datafram": 0, "direct": 0, "also": 0, "analyz": 0, "both": 0, "execut": 0, "speedup": 0, "each": 0, "do": 0, "measur": 0, "action": 0, "process": 0, "exclud": 0, "previou": 0, "transform": 0, "thei": 0, "ar": 0, "The": [0, 1], "follow": 0, "done": 0, "five": 0, "version": 0, "df": 0, "zone": 0, "pip": 0, "instal": 0, "findspark": 0, "start": 0, "session": 0, "all": 0, "our": 0, "comput": [0, 1], "divid": 0, "coalesc": 0, "32": 0, "howev": 0, "differ": 0, "test": 0, "import": 0, "init": 0, "from": 0, "pyspark": 0, "sparksess": 0, "builder": 0, "appnam": 0, "intro": 0, "master": 0, "local": 0, "getorcr": 0, "sc": 0, "sparkcontext": 0, "pd": 0, "numpi": 0, "np": 0, "seaborn": 0, "sn": 0, "matplotlib": 0, "pyplot": 0, "plt": 0, "set_styl": 0, "whitegrid": 0, "function": 0, "round": 0, "expr": 0, "from_unixtim": 0, "unix_timestamp": 0, "date_format": 0, "count": 0, "concat": 0, "lit": 0, "col": 0, "type": 0, "integertyp": 0, "pysparkruntimeerror": [], "traceback": [], "recent": [], "call": [], "last": 0, "cell": [], "line": [], "6": 0, "4": 0, "9": 0, "c": [], "program": [], "x86": [], "5": 0, "0": 0, "bin": [], "hadoop3": [], "python": 1, "py": [], "497": [], "self": [], "495": [], "sparkconf": [], "kei": 0, "valu": 0, "496": [], "mai": [], "an": 0, "exist": [], "one": 0, "498": [], "updat": [], "share": 0, "499": [], "500": [], "option": 0, "_option": [], "context": [], "515": [], "cl": [], "conf": [], "513": [], "_lock": [], "514": [], "_active_spark_context": [], "i": [0, 1], "none": [], "516": [], "assert": [], "517": [], "return": 0, "201": [], "__init__": [], "sparkhom": [], "pyfil": [], "environ": [], "batchsiz": [], "serial": [], "gatewai": [], "jsc": [], "profiler_cl": [], "udf_profiler_cl": [], "memory_profiler_cl": [], "195": [], "gateway_paramet": [], "auth_token": [], "196": [], "rais": [], "valueerror": [], "197": [], "you": 0, "try": [], "pass": [], "insecur": [], "py4j": [], "198": [], "allow": 0, "secur": [], "risk": [], "199": [], "_ensure_initi": [], "202": [], "203": [], "_do_init": [], "204": [], "205": 0, "215": [], "216": [], "436": [], "instanc": [], "434": [], "435": [], "_gatewai": [], "launch_gatewai": [], "437": [], "_jvm": [], "jvm": [], "439": [], "java_gatewai": [], "107": [], "popen_kwarg": [], "104": [], "sleep": [], "106": [], "o": 0, "path": [], "isfil": [], "conn_info_fil": [], "108": [], "error_class": [], "java_gateway_exit": [], "109": [], "message_paramet": [], "110": [], "112": [], "open": 0, "rb": 0, "info": [], "113": [], "gateway_port": [], "read_int": [], "java": [], "exit": [], "befor": 0, "send": 0, "its": 0, "port": [], "next": 0, "read": 0, "taxis_df": 0, "format": 0, "inferschema": 0, "true": 0, "timestampformat": 0, "yyyi": 0, "mm": 0, "dd": 0, "hh": 0, "ss": 0, "header": 0, "mode": 0, "dropmalform": 0, "load": 0, "r": 0, "show": 0, "vendorid": 0, "tpep_pickup_datetim": 0, "tpep_dropoff_datetim": 0, "passenger_count": 0, "trip_dist": 0, "ratecodeid": 0, "store_and_fwd_flag": 0, "pulocationid": 0, "dolocationid": 0, "payment_typ": 0, "fare_amount": 0, "extra": 0, "mta_tax": 0, "tip_amount": 0, "tolls_amount": 0, "improvement_surcharg": 0, "total_amount": 0, "2017": 0, "01": 0, "09": 0, "11": 0, "13": 0, "28": 0, "25": 0, "45": 0, "n": 0, "263": 0, "161": 0, "12": 0, "15": 0, "27": 0, "36": 0, "186": 0, "234": 0, "38": 0, "20": 0, "42": 0, "05": 0, "164": 0, "52": 0, "57": 0, "236": 0, "75": 0, "8": 0, "00": 0, "02": 0, "249": 0, "onli": 0, "top": 0, "row": 0, "describ": 0, "summari": 0, "971010": 0, "mean": 0, "5569510097733288": 0, "6859888157691476": 0, "031284878631537": 0, "0447286845655555": 0, "null": 0, "160": 0, "37803112223355": 0, "158": 0, "5567120832947": 0, "3719735121162502": 0, "10818815460192": 0, "20999277041431086": 0, "4972142408420099": 0, "6790282695337968": 0, "28018088382202855": 0, "2996286341025702": 0, "16": 0, "078110822769524": 0, "stddev": 0, "49674624971879267": 0, "2917046837574016": 0, "7858472332117143": 0, "46163126537430665": 0, "67": 0, "93819834229225": 0, "72": 0, "27682104933889": 0, "5033263270235161": 0, "546": 0, "7369331191042": 0, "2616340036820127": 0, "04058594644609154": 0, "571364110419965": 0, "7369077136569349": 0, "014468410899185406": 0, "7901022658472": 0, "min": 0, "120": 0, "06": 0, "max": 0, "151": 0, "99": 0, "y": 0, "265": 0, "538579": 0, "55": 0, "54": 0, "366": 0, "905": 0, "538580": 0, "now": 0, "go": 0, "prevent": 0, "error": 0, "calcul": 0, "start_tim": 0, "zero": 0, "durat": 0, "order": 0, "those": 0, "which": 0, "made": 0, "between": 0, "dropoff": 0, "datetim": 0, "pickup": 0, "As": 0, "given": 0, "second": 0, "3600": 0, "obtain": 0, "withcolumn": 0, "trip_duration_hour": 0, "filter": 0, "970052": 0, "969319": 0, "upper": 0, "quantil": 0, "select": 0, "collect": 0, "q25": 0, "float": 0, "q75": 0, "iqr": 0, "upper_bound": 0, "end_tim": 0, "data_cleaning_spark_df_tim": 0, "print": 0, "593500852584839": 0, "900387": 0, "tabl": 0, "contain": 0, "brief": 0, "preciou": 0, "well": 0, "variabl": 0, "A": 0, "code": 0, "indic": 0, "tpep": 0, "creativ": 0, "mobil": 0, "technologi": 0, "llc": 0, "verifon": 0, "inc": 0, "date": 0, "when": 0, "meter": 0, "engag": 0, "disengag": 0, "passeng": 0, "vehicl": 0, "quantit": 0, "elaps": 0, "distanc": 0, "mile": 0, "report": 0, "taximet": 0, "tlc": 0, "final": 0, "rate": 0, "effect": 0, "end": 0, "standard": 0, "jfk": 0, "newark": 0, "nassau": 0, "westchest": 0, "negoti": 0, "fare": 0, "group": 0, "ride": 0, "categor": 0, "flag": 0, "whether": 0, "held": 0, "memori": 0, "vendor": 0, "aka": 0, "store": 0, "forward": 0, "becaus": 0, "did": 0, "connect": 0, "server": 0, "numer": 0, "signifi": 0, "how": 0, "paid": 0, "credit": 0, "card": 0, "cash": 0, "No": 0, "charg": 0, "disput": 0, "unknown": 0, "void": 0, "miscellan": 0, "surcharg": 0, "current": 0, "50": 0, "rush": 0, "overnight": 0, "mta": 0, "tax": 0, "automat": 0, "trigger": 0, "base": 0, "30": 0, "improv": 0, "assess": 0, "drop": 0, "urcharg": 0, "began": 0, "being": 0, "levi": 0, "2015": 0, "amount": 0, "field": 0, "popul": 0, "total": 0, "toll": 0, "doe": 0, "congestion_surcharg": 0, "ny": 0, "congest": 0, "airport_fe": 0, "dai": 0, "abl": 0, "traffic": 0, "citi": 0, "step": 0, "convert": 0, "kilomet": 0, "over": 0, "plot": 0, "result": 0, "taxis_df_copi": 0, "alia": 0, "059": 0, "trip_distance_km": 0, "609344": 0, "trip_speed_km_h": 0, "hour_tim": 0, "hours_speed_df": 0, "groupbi": 0, "cast": 0, "column": 0, "integ": 0, "hours_speed_df_pd": 0, "topanda": 0, "task1_spark_df_tim": 0, "0894644260406494": 0, "figur": 0, "figsiz": 0, "10": 0, "lineplot": 0, "x": 0, "avg": 0, "color": 0, "red": 0, "xlabel": 0, "ylabel": 0, "titl": 0, "xtick": 0, "rang": 0, "24": 0, "rotat": 0, "ysticks_": 0, "uniqu": 0, "linspac": 0, "ytick": 0, "tight_layout": 0, "def": 0, "calculate_elapsed_hour": 0, "elapsed_tim": 0, "total_second": 0, "trip_distance_rdd": 0, "map": 0, "lambda": 0, "trip_distance_km_rdd": 0, "tpep_dropoff_datetime_rdd": 0, "tpep_pickup_datetime_rdd": 0, "datetime_rdd": 0, "trip_duration_rdd": 0, "trip_distance_time_rdd": 0, "zip": 0, "trip_speed_rdd": 0, "trip_hour_rdd": 0, "key_hour_rdd": 0, "trip_hour_sum_hour_rdd": 0, "reducebykei": 0, "trip_hour_speed_rdd": 0, "trip_hour_sum_speed_rdd": 0, "avg_speed_hour_rdd": 0, "hours_new_order_rdd": 0, "avg_speed_hour_list": 0, "hours_new_order_list": 0, "task1_spark_rdd_tim": 0, "936208009719849": 0, "createorreplacetempview": 0, "AS": 0, "int": 0, "BY": 0, "task1_spark_sql_tim": 0, "2889022827148438": 0, "taxis_df_pd": 0, "read_csv": 0, "head": 0, "90": 0, "70": 0, "80": 0, "shape": 0, "17": 0, "to_datetim": 0, "dt": 0, "loc": 0, "data_cleaning_pandas_tim": 0, "8886573314666748": 0, "18": 0, "task1_pandas_tim": 0, "0503997802734375": 0, "index": 0, "nesxt": 0, "locat": 0, "join": 0, "get": 0, "zones_df": 0, "locationid": 0, "264": 0, "group_by_df": 0, "agg": 0, "trip_count": 0, "orderbi": 0, "ascend": 0, "fals": 0, "pu_joined_df": 0, "inner": 0, "withcolumnrenam": 0, "borough_pu": 0, "zone_pu": 0, "trip_count_pu": 0, "do_joined_df": 0, "borough_do": 0, "zone_do": 0, "zones_trips_df": 0, "zones_trips_sorted_df": 0, "task2_spark_df_tim": 0, "manhattan": 0, "east": 0, "side": 0, "3433": 0, "3149": 0, "3005": 0, "sq": 0, "theatr": 0, "west": 0, "chelsea": 0, "hud": 0, "2940": 0, "villag": 0, "2877": 0, "2719": 0, "lincoln": 0, "squar": 0, "2594": 0, "2536": 0, "2470": 0, "penn": 0, "station": 0, "madi": 0, "2202": 0, "124625205993652": 0, "zone_pu_do": 0, "zones_trips_sorted_df_pd": 0, "barplot": 0, "green": 0, "ten": 0, "join_df": 0, "tip_amount_avg": 0, "ON": 0, "where": 0, "desc": 0, "task3_spark_sql_tim": 0, "brooklyn": 0, "5295506094329612": 0, "queen": 0, "3814509977827034": 0, "3054620174908678": 0, "staten": 0, "island": 0, "1371428571428572": 0, "ewr": 0, "bronx": 0, "4036954915003696": 0, "7581818103790283": 0, "join_df_pd": 0, "orang": 0, "section": 0, "up": 0, "different": 0, "distinct": 0, "creat": 0, "them": 0, "make": 0, "arrai": 0, "51055": 0, "5567": 0, "8198": 0, "1175": 0, "0512": 0, "4139": 0, "902377": 0, "45250": 0, "49201": 0, "60570": 0, "2375": 0, "8649": 0, "34": 0, "256966": 0, "21": 0, "998392": 0, "01433": 0, "94407": 0, "6878": 0, "96136": 0, "7926690": 0, "687486": 0, "9901852": 0, "642264": 0, "2889": 0, "14359": 0, "040179": 0, "647932": 0, "729816": 0, "35511": 0, "1246": 0, "066134": 0, "1619": 0, "180148": 0, "62037": 0, "56909": 0, "4121": 0, "15730": 0, "df_time": 0, "dict": 0, "792669": 0, "161900": 0, "55670": 0, "452500": 0, "81980": 0, "492010": 0, "014330": 0, "990185": 0, "620370": 0, "11750": 0, "605700": 0, "944070": 0, "355110": 0, "569090": 0, "05120": 0, "237500": 0, "687800": 0, "288900": 0, "124600": 0, "412100": 0, "41390": 0, "864900": 0, "961360": 0, "143590": 0, "157300": 0, "compar": [0, 1], "label": 0, "blue": 0, "sec": 0, "legend": 0, "df_speed_up": 0, "len": 0, "col_nam": 0, "els": 0, "base_tim": 0, "iloc": 0, "000000": 0, "515186": 0, "709595": 0, "557249": 0, "842087": 0, "660694": 0, "937614": 0, "239258": 0, "368521": 0, "901651": 0, "271655": 0, "926795": 0, "351538": 0, "460211": 0, "265179": 0, "909097": 0, "570776": 0, "061616": 0, "398476": 0, "483343": 0, "637934": 0, "052815": 0, "967657": 0, "154349": 0, "554579": 0, "730094": 0, "164983": 0, "019706": 0, "168828": 0, "179212": 0, "856302": 0, "below": 0, "other": 0, "method": 0, "repres": 0, "effici": 0, "same": 0, "focus": 0, "u": 0, "evid": 0, "slowest": 0, "while": 0, "similar": 0, "especi": 0, "higher": 0, "surprisingli": 0, "observ": 0, "expect": 0, "size": 0, "might": 0, "suffici": 0, "plan": 0, "explor": 0, "further": 0, "better": 0, "understand": 0, "behavior": 0, "subsequ": 0, "reveal": 0, "more": 0, "promis": 0, "outcom": 0, "onc": 0, "again": 0, "exhibit": 0, "slower": 0, "increas": 0, "sole": 0, "valuabl": 0, "although": 0, "displai": 0, "slightli": 0, "slope": 0, "evolut": 0, "demonstr": 0, "good": 0, "scalabl": 0, "ha": 0, "been": 0, "build": 0, "extract": 0, "after": 0, "meticul": 0, "procedur": 0, "expos": 0, "consid": 0, "baselin": 0, "million": 0, "approx": 0, "bigger": 0, "just": 0, "copi": 0, "concaten": 0, "techniqu": 0, "four": 0, "origin": 0, "much": 0, "specif": 0, "62": 0, "124": 0, "respect": 0, "carefulli": 0, "repeat": 0, "metric": 0, "detail": 0, "1m": 0, "15m": 0, "due": 0, "extrem": 0, "high": 0, "cost": 0, "experi": 0, "approach": 0, "combin": 0, "62m": 0, "124m": 0, "186m": 0, "smart": 0, "wai": 0, "summar": 0, "clever": 0, "beauti": 0, "pickl": 0, "itertool": 0, "product": 0, "dictionari": 0, "save": 0, "spark_times_df_dict": 0, "back": 0, "pandas_times_df_dict": 0, "polars_times_df_dict": 0, "taxis_15m": 0, "taxis_62m": 0, "taxis_124m": 0, "taxis_186m": 0, "data_reading_spark": 0, "data_cleaning_spark": 0, "task1_spark": 0, "rdd_time": 0, "sql_time": 0, "data_reading_pandas_tim": 0, "data_reading_polars_tim": 0, "data_cleaning_polars_tim": 0, "task1_polars_tim": 0, "data_nam": 0, "data_read": 0, "data_clean": 0, "task1": 0, "df_name": 0, "avg_tim": 0, "times_df_dict": 0, "name": 0, "global": 0, "f": 0, "_times_df_dict": 0, "filtered_product": 0, "nan": 0, "_": 0, "_time": 0, "total_time_v1": 0, "sum": 0, "total_time_v2": 0, "all_task": 0, "defin": 0, "matrix": 0, "num_col": 0, "can": 0, "adjust": 0, "need": 0, "n_task": 0, "num_row": 0, "ceil": 0, "data_s": 0, "subplot": 0, "specifi": 0, "fig": 0, "ax": 0, "flatten": 0, "easier": 0, "iter": 0, "n_method": 0, "color_palett": 0, "tab10": 0, "loop": 0, "through": 0, "geo": 0, "enumer": 0, "axi": 0, "marker": 0, "markers": 0, "linestyl": 0, "linewidth": 0, "set_xlabel": 0, "fontsiz": 0, "set_ylabel": 0, "tick_param": 0, "set_titl": 0, "14": 0, "weight": 0, "normal": 0, "style": 0, "ital": 0, "black": 0, "get_legend": 0, "individu": 0, "third": 0, "gener": 0, "handl": [0, 1], "get_legend_handles_label": 0, "ani": 0, "unus": 0, "case": 0, "less": 0, "than": 0, "j": 0, "delax": 0, "add": 0, "outsid": 0, "lower": 0, "center": 0, "bbox_to_anchor": 0, "ncol": 0, "suptitl": 0, "comparison": 0, "bold": 0, "alpha": 0, "establish": 0, "tittl": 0, "subplots_adjust": 0, "hspace": 0, "wspace": 0, "vertic": 0, "horizont": 0, "space": 0, "savefig": 0, "spark_pandas_polar": 0, "jpg": 0, "dpi": 0, "600": 0, "bbox_inch": 0, "tight": 0, "some": 0, "moder": 0, "rather": 0, "becom": 0, "too": 0, "slow": 0, "librari": 0, "real": 0, "big": 0, "On": 0, "hand": 0, "almost": 0, "even": 0, "quit": 0, "massiv": 0, "great": 0, "power": [0, 1], "appear": 0, "scene": 0, "achiev": 0, "parallel": 0, "shown": 0, "larg": 0, "enough": 0, "64m": 0, "suggest": 0, "small": [], "sampl": [], "book": [], "give": [], "feel": [], "content": [], "structur": [], "It": [], "off": [], "few": [], "major": [], "depth": [], "particular": [], "topic": [], "check": [], "jupyt": [], "document": [], "page": [], "bundl": [], "see": [], "v": 1, "main": 1, "purpos": 1, "most": 1, "outstand": 1, "framework": 1, "data": 1}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"spark": [0, 1], "v": 0, "panda": [0, 1], "polar": [0, 1], "time": [0, 1], "analysi": [0, 1], "introduct": 0, "requir": 0, "data": 0, "clean": 0, "frame": 0, "set": 0, "conceptu": 0, "descript": 0, "class": 0, "anchor": 0, "id": 0, "7": 0, "studi": 0, "1": 0, "averag": 0, "speed": 0, "taxi": 0, "term": 0, "hour": 0, "With": 0, "rdd": 0, "sql": 0, "perform": 0, "task": 0, "2": 0, "most": 0, "common": 0, "trip": 0, "3": 0, "tip": 0, "per": 0, "borough": 0, "number": 0, "core": 0, "conclus": 0}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9, "sphinx": 60}, "alltitles": {"Spark vs Pandas vs Polars: time analysis": [[0, "spark-vs-pandas-vs-polars-time-analysis"]], "Introduction": [[0, "introduction"]], "Requirements": [[0, "requirements"]], "Data cleaning with Spark data-frames": [[0, "data-cleaning-with-spark-data-frames"]], "Data-set conceptual description <a class=\"anchor\" id=\"7\"></a>": [[0, "data-set-conceptual-description"]], "Study 1: Average speed of taxis in terms of the hour": [[0, "study-1-average-speed-of-taxis-in-terms-of-the-hour"]], "With Spark data-frames": [[0, "with-spark-data-frames"]], "With Spark RDD": [[0, "with-spark-rdd"]], "With Spark SQL": [[0, "with-spark-sql"]], "With Pandas": [[0, "with-pandas"]], "Data cleaning with Pandas": [[0, "data-cleaning-with-pandas"]], "Performing the task": [[0, "performing-the-task"]], "Study 2: Most common taxi trips": [[0, "study-2-most-common-taxi-trips"]], "Study 3: Average of tips per borough": [[0, "study-3-average-of-tips-per-borough"]], "Time Analysis": [[0, "time-analysis"]], "Spark and number of cores": [[0, "spark-and-number-of-cores"]], "Conclusions": [[0, "conclusions"]], "Spark vs Pandas vs Polars": [[0, "spark-vs-pandas-vs-polars"]], "Time Analysis of Spark, Polars and Pandas": [[1, "time-analysis-of-spark-polars-and-pandas"]]}, "indexentries": {}})